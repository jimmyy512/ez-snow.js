{"version":3,"file":"ezSnow.umd.js","sources":["../lib/ezSnow/ezSnow.js"],"sourcesContent":["class ezSnow {\r\n  constructor(appendDomName = \"body\", srcPath) {\r\n    var img = new Image();\r\n    img.src = srcPath;\r\n    if (img.width == 0) {\r\n      img.onload = () => {\r\n        this._bgWidth = img.width;\r\n        this._bgHeight = img.height;\r\n        this.init();\r\n      };\r\n    }\r\n\r\n    this._imgs = new Array();\r\n    this._srcPath = srcPath;\r\n    this._isInit = false;\r\n    this._appendDom = document.querySelector(appendDomName);\r\n    this._appendDom.style.position = \"relative\";\r\n    this._RAF = null;\r\n    this._RAF_then = null;\r\n    this._const_FPS = 60;\r\n    this._bgWidth = img.width;\r\n    this._bgHeight = img.height;\r\n    this._imgSum = 10;\r\n    this._isFullMode = true;\r\n    this._ScaleMax = 0;\r\n    this._ScaleMin = 0;\r\n    this._phyVx = 0.1;\r\n    this._phyVy = [0.1, 0.35];\r\n    this._isRandDireciotn = true;\r\n    this._directionWay = true;\r\n    this._startFadeOutDistance = 50;\r\n    this._fadeFactor = 0.05;\r\n    this._startFade = 1;\r\n    this.customEvent = null;\r\n  }\r\n\r\n  init() {\r\n    if (this._bgWidth == 0) return this;\r\n    if (this._isInit) {\r\n      this._warnTip(\r\n        \"init\",\r\n        \"if you want reinit plz call destroy() before init()!!\"\r\n      );\r\n      return;\r\n    }\r\n\r\n    for (let i = 0; i < this._imgSum; i++) {\r\n      let randSizeScale = 1;\r\n      if (this._ScaleMax === 0 && this._ScaleMin === 0) randSizeScale = 1;\r\n      else if (this._ScaleMax !== 0 && this._ScaleMin === 0)\r\n        randSizeScale = this._ScaleMax;\r\n      else randSizeScale = Math.random() * this._ScaleMax + this._ScaleMin;\r\n\r\n      let img = document.createElement(\"img\");\r\n      img.style.position = \"absolute\";\r\n      img.style.backgroundSize = \"contain\";\r\n      img.style.pointerEvents = \"none\";\r\n      img.src = this._srcPath;\r\n      img.innerText = \"\";\r\n      img.style.width = `${this._bgWidth * randSizeScale}px`;\r\n      img.style.height = `${this._bgHeight * randSizeScale}px`;\r\n      img.style.opacity = 0;\r\n\r\n      img.ezSnow = {\r\n        opacity: 0,\r\n        sizeScale: randSizeScale,\r\n        pos: {\r\n          x: Math.random() * this._appendDom.clientWidth + 1,\r\n          y: this.isFullMode\r\n            ? Math.random() * this._appendDom.clientHeight + 1\r\n            : 0\r\n        }\r\n      };\r\n      this._appendDom.appendChild(img);\r\n      this._imgs.push(img);\r\n    }\r\n    this._ezSnowDataSync();\r\n    this.callRequestAnimationFrame();\r\n    this._isInit = true;\r\n    return this;\r\n  }\r\n\r\n  callRequestAnimationFrame() {\r\n    this._RAF = requestAnimationFrame(() => {\r\n      this.callRequestAnimationFrame();\r\n      let fpsInterval = 1000 / this._const_FPS;\r\n      let now = Date.now();\r\n      let elapsed = now - this._RAF_then;\r\n      if (elapsed > fpsInterval) {\r\n        this._imgs.forEach((it, index) => {\r\n          let { phy } = it.ezSnow;\r\n          let { pos } = it.ezSnow;\r\n\r\n          if (\r\n            this._phyVy > 0 &&\r\n            this._appendDom.clientHeight - this._bgHeight - pos.y <\r\n            this._startFadeOutDistance\r\n          ) {\r\n            it.ezSnow.opacity -= this._fadeFactor;\r\n            if (it.ezSnow.opacity < 0) it.ezSnow.opacity = 0;\r\n            it.style.opacity = it.ezSnow.opacity;\r\n          } else if (this._phyVy < 0 && pos.y < this._startFadeOutDistance) {\r\n            it.ezSnow.opacity -= this._fadeFactor;\r\n            if (it.ezSnow.opacity < 0) it.ezSnow.opacity = 0;\r\n            it.style.opacity = it.ezSnow.opacity;\r\n          } else if (it.ezSnow.opacity < this._startFade) {\r\n            it.ezSnow.opacity += this._fadeFactor;\r\n            it.style.opacity = it.ezSnow.opacity;\r\n          }\r\n\r\n          if (this._isRandDireciotn) {\r\n            if (\r\n              it.ezSnow._reverseCount >= it.ezSnow._reverseJudge &&\r\n              Math.floor(Math.random() * 2)\r\n            ) {\r\n              it.ezSnow._reverseCount = 0;\r\n              it.ezSnow._reverseDirection = !it.ezSnow._reverseDirection;\r\n            } else it.ezSnow._reverseCount++;\r\n          }\r\n\r\n          let newVX = phy.vX;\r\n          if (it.ezSnow._reverseDirection) newVX = 0 - phy.vX;\r\n\r\n          it.style.left = pos.x + newVX + \"px\";\r\n          it.style.top = pos.y + phy.vY + \"px\";\r\n          pos.x += newVX;\r\n          pos.y += phy.vY;\r\n\r\n          if (\r\n            pos.y >\r\n            this._appendDom.clientHeight - this._bgHeight * it.ezSnow.sizeScale\r\n          ) {\r\n            it.style.top = 0;\r\n            pos.y = 0;\r\n            it.ezSnow.opacity = 0;\r\n            it.style.opacity = 0;\r\n          } else if (pos.y < 0) {\r\n            it.style.top =\r\n              this._appendDom.clientHeight -\r\n              this._bgHeight * it.ezSnow.sizeScale;\r\n            pos.y =\r\n              this._appendDom.clientHeight -\r\n              this._bgHeight * it.ezSnow.sizeScale;\r\n            it.ezSnow.opacity = 0;\r\n            it.style.opacity = 0;\r\n          }\r\n\r\n          if (\r\n            pos.x >\r\n            this._appendDom.clientWidth -\r\n            this._bgWidth * it.ezSnow.sizeScale ||\r\n            pos.x < 0\r\n          )\r\n            this.resetPos(it);\r\n\r\n          if (this.customEvent !== null) this.customEvent(it, index);\r\n        });\r\n        this._RAF_then = now - (elapsed % fpsInterval);\r\n      }\r\n    });\r\n  }\r\n\r\n  setAutoDirection(isRandDireciotn, directionWay) {\r\n    if (typeof isRandDireciotn !== \"boolean\") {\r\n      this._warnTip(\r\n        \"setDirection\",\r\n        \"param need boolean,directionWay:true,snow will float right.\"\r\n      );\r\n      return;\r\n    }\r\n    if (!isRandDireciotn) this._directionWay = directionWay;\r\n    this._isRandDireciotn = isRandDireciotn;\r\n    return this;\r\n  }\r\n\r\n  setScale(ScaleMin = 0, ScaleMax = 0) {\r\n    if (typeof ScaleMax !== \"number\" || typeof ScaleMin !== \"number\") {\r\n      this._warnTip(\"setScale\", \"ScaleMax、ScaleMin need number.\");\r\n      return;\r\n    }\r\n\r\n    this._ScaleMax = ScaleMax;\r\n    this._ScaleMin = ScaleMin;\r\n    return this;\r\n  }\r\n\r\n  setPhysics(Vx = this._phyVx, Vy = this._phyVy) {\r\n    this._phyVx = Vx;\r\n    this._phyVy = Vy;\r\n    this._ezSnowDataSync();\r\n    return this;\r\n  }\r\n\r\n  setFullMode(isFullMode) {\r\n    if (typeof isFullMode !== \"boolean\") {\r\n      this._warnTip(\"setFullMode\", \"param need boolean.\");\r\n      return;\r\n    }\r\n    this.isFullMode = isFullMode;\r\n    return this;\r\n  }\r\n\r\n  setNum(snowSum) {\r\n    if (typeof snowSum !== \"number\") {\r\n      this._warnTip(\"setNum\", \"param need number \");\r\n      return;\r\n    }\r\n    this._imgSum = snowSum;\r\n    return this;\r\n  }\r\n\r\n  setOpacity(fade) {\r\n    if (typeof fade !== \"number\") {\r\n      this._warnTip(\"setOpacity\", \"param need number \");\r\n      return;\r\n    }\r\n    this._startFade = fade;\r\n    return this;\r\n  }\r\n\r\n  setLeaveFadeFactor(fadeFactor) {\r\n    if (typeof fadeFactor !== \"number\") {\r\n      this._warnTip(\"setLeaveFadeFactor\", \"param need number.\");\r\n      return;\r\n    }\r\n    this._fadeFactor = fadeFactor;\r\n    return this;\r\n  }\r\n\r\n  setFadeOutDistance(distance) {\r\n    if (typeof distance !== \"number\") {\r\n      this._warnTip(\"setFadeOutDistance\", \"param need number.\");\r\n      return;\r\n    }\r\n    this._startFadeOutDistance = distance;\r\n    return this;\r\n  }\r\n\r\n  setCustomEvent(event) {\r\n    if (typeof event !== \"function\") {\r\n      this._warnTip(\"setCustomEvent\", \"param need function.\");\r\n      return;\r\n    }\r\n    this.customEvent = event;\r\n    return this;\r\n  }\r\n\r\n  destroy() {\r\n    cancelAnimationFrame(this._RAF);\r\n    this._clearAllSnow();\r\n    this._isInit = false;\r\n  }\r\n\r\n  reInit() {\r\n    this.destroy();\r\n    this.init();\r\n  }\r\n\r\n  resetPos(snow) {\r\n    let newPosX;\r\n    newPosX =\r\n      Math.random() * this._appendDom.clientWidth -\r\n      this._bgWidth * snow.ezSnow.sizeScale;\r\n    let newPosY = 0;\r\n    snow.ezSnow.pos.x = newPosX;\r\n    snow.ezSnow.pos.y = newPosY;\r\n    snow.style.left = newPosX;\r\n    snow.style.top = newPosY;\r\n    snow.ezSnow._reverseCount = 0;\r\n    snow.ezSnow.opacity = 0;\r\n    snow.style.opacity = 0;\r\n  }\r\n\r\n  _clearAllSnow() {\r\n    this._imgs.forEach((it, index) => {\r\n      this._appendDom.removeChild(it);\r\n    });\r\n    this._imgs.length = 0;\r\n  }\r\n\r\n  _warnTip(functionName, content) {\r\n    console.error(`ezSnow.js error! ${functionName} fail,${content}`);\r\n  }\r\n\r\n  _ezSnowDataSync() {\r\n    this._imgs.forEach((it, index) => {\r\n      it.ezSnow.phy = {\r\n        vX: Array.isArray(this._phyVx)\r\n          ? Math.random() * this._phyVx[1] + this._phyVx[0]\r\n          : this._phyVx,\r\n        vY: Array.isArray(this._phyVy)\r\n          ? Math.random() * this._phyVy[1] + this._phyVy[0]\r\n          : this._phyVy\r\n      };\r\n      it.ezSnow._reverseJudge = Math.floor(Math.random() * 2000) + 200;\r\n      it.ezSnow._reverseDirection = this._isRandDireciotn\r\n        ? Math.floor(Math.random() * 2)\r\n        : this._directionWay;\r\n      it.ezSnow._reverseCount = 0;\r\n    });\r\n  }\r\n}\r\n\r\nexport default ezSnow;\r\n"],"names":["appendDomName","srcPath","img","Image","src","width","onload","_this","_bgWidth","_bgHeight","height","init","_imgs","Array","_srcPath","_isInit","_appendDom","document","querySelector","style","position","_RAF","_RAF_then","_const_FPS","_imgSum","_isFullMode","_ScaleMax","_ScaleMin","_phyVx","_phyVy","_isRandDireciotn","_directionWay","_startFadeOutDistance","_fadeFactor","_startFade","customEvent","this","i","randSizeScale","Math","random","createElement","backgroundSize","pointerEvents","innerText","opacity","ezSnow","sizeScale","pos","x","clientWidth","y","isFullMode","clientHeight","appendChild","push","_ezSnowDataSync","callRequestAnimationFrame","_warnTip","requestAnimationFrame","_this2","fpsInterval","now","Date","elapsed","forEach","it","index","phy","_reverseCount","_reverseJudge","floor","_reverseDirection","newVX","vX","left","top","vY","resetPos","isRandDireciotn","directionWay","ScaleMin","ScaleMax","Vx","Vy","snowSum","fade","fadeFactor","distance","event","cancelAnimationFrame","_clearAllSnow","destroy","snow","newPosX","_this3","removeChild","length","functionName","content","console","error","isArray","_this4"],"mappings":"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"}